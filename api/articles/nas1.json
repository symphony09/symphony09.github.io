{"title":"NAS 折腾记","uid":"5e6bac11d8337953e8e2ec023a083948","slug":"nas1","date":"2021-07-26T03:29:41.000Z","updated":"2024-06-13T14:30:24.333Z","comments":true,"path":"api/articles/nas1.json","keywords":null,"cover":"https://w.wallhaven.cc/full/43/wallhaven-43zkod.jpg","content":"<p>因为本人没多少money，加上喜欢折腾，所以并未采用现成的 NAS 方案，选择自己凑配硬件搭建。在21年初初步搭建完成，现在已经平稳运行半年左右，还算满意。现在得空分享一下搭建经验，供同好参考。</p>\n<h2 id=\"方案介绍\"><a href=\"#方案介绍\" class=\"headerlink\" title=\"方案介绍\"></a>方案介绍</h2><p>不同于常见的多盘位 NAS 机箱，我采用了迷你主机加硬盘盒的形式，通过网线连接路由器提供 NAS 服务。</p>\n<p>其实市面上也有类似的方案，如雷克沙时光机。与多盘位机箱相比，这种方案的优点是占用空间小，可以轻松的的放进包里，硬盘也不会被限制在机器上。</p>\n<p>有优点当然也有缺点，这种方案只适合轻量 NAS 。上面提到的雷克沙时光机仅有一个 USB 接口，在不考虑拓展坞的情况下只能连接一个硬盘。不过我并没有多么变态的容量需求，所以这一点没什么影响。</p>\n<h2 id=\"硬件\"><a href=\"#硬件\" class=\"headerlink\" title=\"硬件\"></a>硬件</h2><ul>\n<li>NUC 5 PPYH  x 1，加上 4G DDR3 内存和 240G 固态硬盘共600元。</li>\n</ul>\n<p>NUC 是英特尔推出的迷你主机准系统，因为是准系统，所以需要自购内存硬盘才能跑起来。CPU 为 奔腾 4 核处理器，1.6~2.4GHZ， TDP 只有6w，适合长期运行。</p>\n<p>接口方面，有4个USB3.0，一个HDMI和DP，一个千兆网口，还有3.5mm音频接口。</p>\n<p>这个机子本来是作为普通电脑使用的，顺便作为NAS设备使用完全够用。</p>\n<ul>\n<li>西数紫盘 2T x 1，加上硬盘盒共430元。</li>\n</ul>\n<p>硬盘没啥好说的，避开叠瓦盘盘然后选个容量适合就OK。硬盘盒就看支不支持USB3.0和自动休眠，材质的话金属散热好点。</p>\n<h2 id=\"软件\"><a href=\"#软件\" class=\"headerlink\" title=\"软件\"></a>软件</h2><h3 id=\"系统\"><a href=\"#系统\" class=\"headerlink\" title=\"系统\"></a>系统</h3><p>Windows 是不可能用 Windows 的，一开始我看同事在用 openSUSE ，所以也装了个尝尝鲜。总体使用体验还是可以的，YaST 工具非常好用。只可惜社区基本凉凉，搜到的文章资料又少又老。</p>\n<p>后来换了Manjaro，基于大名鼎鼎的 Arch Linux，使用体验非常好，软件包又全又新。比如 docker、hugo（静态网站生成器） 可以直接用 pacman 命令安装，go 版本基本与官网保持同步。中间出过重启会卡住的问题，将内核版本降到5.4就OK了。</p>\n<h3 id=\"应用\"><a href=\"#应用\" class=\"headerlink\" title=\"应用\"></a>应用</h3><ul>\n<li>docker，运行各种应用</li>\n<li>portainer，docker 管理</li>\n<li>samba，网络共享挂载的磁盘</li>\n<li>netdata，监控机器运行状态</li>\n<li>aria2+AriaNg、qbittorroent-nox，文件下载</li>\n<li>cloudreve、filebrowser、syncthing，云盘，文件同步</li>\n<li>emby，音视频播放</li>\n<li>hugo、hexo，个人博客</li>\n<li>nginx，部署简单的导航页</li>\n<li>各种小玩意，minikube等</li>\n</ul>\n<h3 id=\"配置\"><a href=\"#配置\" class=\"headerlink\" title=\"配置\"></a>配置</h3><p>基本就是网络配置（固定ip，防火墙），各种软件的安装配置，以及编写 systemd service 开机启动，fstab挂载磁盘。fstab挂载磁盘要小心，建议先试一下，直接重启并且无法挂载磁盘会导致系统进不去，这时就需要进救援模式修复了（亲身经历）。</p>\n<p>详细的以后有空再开篇分享吧，这里先挖个坑。</p>\n<h2 id=\"总结\"><a href=\"#总结\" class=\"headerlink\" title=\"总结\"></a>总结</h2><p>事实上，这个方案确实算不上正经的 NAS，尤其还缺少云同步的功能。但是好在什么都能干，在局域网内跨设备共享文件，也基本满足了我的要求。速度在110MB/s左右，瓶颈在于网络带宽，如果更换为万兆网卡应该可以提升一点速度，但是不多，接口和磁盘（SATA、USB3.0、机械硬盘）会成为新的瓶颈。</p>\n","feature":true,"text":"因为本人没多少money，加上喜欢折腾，所以并未采用现成的 NAS 方案，选择自己凑配硬件搭建。在21年初初步搭建完成，现在已经平稳运行半年左右，还算满意。现在得空分享一下搭建经验，供同好参考。 方案介绍不同于常见的多盘位 NAS 机箱，我采用了迷你主机加硬盘盒的形式，通过网线连...","link":"","photos":[],"count_time":{"symbolsCount":"1.4k","symbolsTime":"1 mins."},"categories":[{"name":"折腾","slug":"折腾","count":1,"path":"api/categories/折腾.json"}],"tags":[{"name":"硬件","slug":"硬件","count":2,"path":"api/tags/硬件.json"},{"name":"nas","slug":"nas","count":1,"path":"api/tags/nas.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E6%96%B9%E6%A1%88%E4%BB%8B%E7%BB%8D\"><span class=\"toc-text\">方案介绍</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E7%A1%AC%E4%BB%B6\"><span class=\"toc-text\">硬件</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E8%BD%AF%E4%BB%B6\"><span class=\"toc-text\">软件</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E7%B3%BB%E7%BB%9F\"><span class=\"toc-text\">系统</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E5%BA%94%E7%94%A8\"><span class=\"toc-text\">应用</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E9%85%8D%E7%BD%AE\"><span class=\"toc-text\">配置</span></a></li></ol></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E6%80%BB%E7%BB%93\"><span class=\"toc-text\">总结</span></a></li></ol>","author":{"name":"年鲤","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"喜欢折腾，随性而为<br/>sunfish69@163.com","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"mapped":true,"prev_post":{"title":"Coroutines for Go -1","uid":"603edc745edac1f578da82734f79ee53","slug":"go_coroutines","date":"2024-06-13T04:00:00.000Z","updated":"2024-06-13T14:30:24.333Z","comments":true,"path":"api/articles/go_coroutines.json","keywords":null,"cover":null,"text":" 这篇文章翻译自 Go 团队主要成员 Russ Cox的协程提案research!rsc: Coroutines for Go (swtch.com)，此协程 coroutines 非彼协程 goroutine，由于全文较长，预计分为两篇，这篇主要说明是什么和为什么。本文采用AI...","link":"","photos":[],"count_time":{"symbolsCount":"6.4k","symbolsTime":"6 mins."},"categories":[{"name":"编程","slug":"编程","count":4,"path":"api/categories/编程.json"}],"tags":[{"name":"golang","slug":"golang","count":5,"path":"api/tags/golang.json"},{"name":"翻译","slug":"翻译","count":1,"path":"api/tags/翻译.json"}],"author":{"name":"年鲤","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"喜欢折腾，随性而为<br/>sunfish69@163.com","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"feature":true},"next_post":{"title":"Golang标准库：sync","uid":"4dbb2ad4d40b43ce8f2a583cb86bc39c","slug":"go-sync","date":"2021-07-04T05:35:41.000Z","updated":"2024-06-13T14:30:24.333Z","comments":true,"path":"api/articles/go-sync.json","keywords":null,"cover":"https://w.wallhaven.cc/full/y8/wallhaven-y85ojk.png","text":"sync 包​ 虽然go主要通过协程和通道来完成同步，但是在某些情况下使用sync包提供的同步更加简洁和巧妙。下面列举sync包的应用场景及相应的用法和坑。 一：单例单例是经常要用到的一个编程模式，go最简单的单例实现就是使用 sync.One 示例package main im...","link":"","photos":[],"count_time":{"symbolsCount":"3.4k","symbolsTime":"3 mins."},"categories":[{"name":"编程","slug":"编程","count":4,"path":"api/categories/编程.json"}],"tags":[{"name":"golang","slug":"golang","count":5,"path":"api/tags/golang.json"},{"name":"标准库","slug":"标准库","count":1,"path":"api/tags/标准库.json"}],"author":{"name":"年鲤","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"喜欢折腾，随性而为<br/>sunfish69@163.com","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"feature":true}}